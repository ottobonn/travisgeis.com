<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.8a856ac569de13b8b669.css" data-identity="gatsby-global-css">@font-face{font-family:Travis Print One;src:url(/static/TravisPrintOne-Regular-395b4112e8d8e4c008f2f27beb638a30.woff2) format("woff2")}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2b2b2b}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#d4d0ab}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{background:window;color:windowText}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}:root{--accent-color:#6a39ff;--code-font:"Anonymous Pro";--code-padding:2em;--code-size:75%;--font-name:"Spectral";--font-size:24px;--header-font:"Rubik",sans-serif;--link-underline:underline;--neutral-background-color:#f9f9f9;--title-box-offset:0.5rem;--title-top-margin:1rem;--link-color:var(--accent-color);--boxy-color:var(--accent-color);--wide-width:100%;--wide-margin-left:0}body{font-family:var(--font-name);font-size:var(--font-size)}h1,h2,h3,h4,h5,h6{font-family:var(--header-font);line-height:1.28571429em;margin:calc(2rem - .14286em) 0 1rem}h1:first-child,h2:first-child,h3:first-child,h4:first-child,h5:first-child,h6:first-child{margin-top:-.14285714em}h1:last-child,h2:last-child,h3:last-child,h4:last-child,h5:last-child,h6:last-child{margin-bottom:0}.boxy,.gatsby-resp-image-wrapper,p>img{background-color:#fff;border:2px solid #000;box-shadow:var(--title-box-offset) var(--title-box-offset) 0 var(--boxy-color)}.gatsby-resp-image-wrapper,p>img{margin-left:var(--wide-margin-left)!important;width:var(--wide-width)}.video-container{background-color:#fff;border:2px solid #000;box-shadow:var(--title-box-offset) var(--title-box-offset) 0 var(--boxy-color);height:0;margin-bottom:2rem;margin-top:2rem;padding-bottom:56.25%;position:relative;width:100%}.video-container iframe{height:100%;left:0;position:absolute;top:0;width:100%}stl-viewer{display:block;height:500px;width:100%}code{font-family:var(--code-font)!important}:not(pre)>code{background-color:#eee!important;border-radius:0!important;color:#000!important;padding:.2em!important}.gatsby-highlight{background-color:#fff;border:2px solid #000;box-shadow:var(--title-box-offset) var(--title-box-offset) 0 var(--boxy-color);margin:.5em 0;margin-left:var(--wide-margin-left);overflow:auto;width:var(--wide-width)}.gatsby-highlight pre[class*=language-]{border-radius:0;margin:0;overflow:hidden;padding:var(--code-padding)}.gatsby-highlight pre[class*=language-] code{display:block;overflow:auto}.gatsby-highlight pre[class*=language-].line-numbers{font-size:var(--code-size);padding-left:3em}.gatsby-highlight pre[class*=language-].line-numbers .line-numbers-rows{border-right:none;left:1em!important;opacity:.5;top:var(--code-padding)}</style><meta name="generator" content="Gatsby 3.15.0"/><title data-react-helmet="true">Drawing fractals in the browser with L-systems and ES6</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Spectral|Rubik|Anonymous+Pro" rel="stylesheet"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png"/><link data-react-helmet="true" rel="apple-touch-icon-precomposed" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicons/favicon-196x196.png" sizes="196x196"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16"/><link data-react-helmet="true" rel="icon" type="image/png" href="/favicons/favicon-128.png" sizes="128x128"/><meta data-react-helmet="true" name="application-name" content="travisgeis.com"/><meta data-react-helmet="true" name="msapplication-TileColor" content="#FFFFFF"/><meta data-react-helmet="true" name="msapplication-TileImage" content="/favicons/mstile-144x144.png"/><meta data-react-helmet="true" name="msapplication-square70x70logo" content="/favicons/mstile-70x70.png"/><meta data-react-helmet="true" name="msapplication-square150x150logo" content="/favicons/mstile-150x150.png"/><meta data-react-helmet="true" name="msapplication-wide310x150logo" content="/favicons/mstile-310x150.png"/><meta data-react-helmet="true" name="msapplication-square310x310logo" content="/favicons/mstile-310x310.png"/><script data-react-helmet="true" type="module" src="/stl-viewer/stl-viewer.js"></script><style data-styled="" data-styled-version="5.3.0">.cnoNVM{max-width:1024px;margin-left:auto;margin-right:auto;}/*!sc*/
data-styled.g4[id="Layout__Container-sc-1arw8t8-0"]{content:"cnoNVM,"}/*!sc*/
.goernf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/*!sc*/
data-styled.g5[id="Menu__MenuContainer-zgpfzl-0"]{content:"goernf,"}/*!sc*/
.hRhFsN{-webkit-text-decoration:none;text-decoration:none;font-family:var(--header-font);-webkit-flex:1;-ms-flex:1;flex:1;text-align:center;padding:0.5em;border-radius:0.25em;color:inherit;}/*!sc*/
.hRhFsN:hover{background-color:#eee;}/*!sc*/
data-styled.g6[id="Menu__MenuLink-zgpfzl-1"]{content:"hRhFsN,"}/*!sc*/
.jmvzGK{border:2px solid black;background-color:white;box-shadow:var(--title-box-offset) var(--title-box-offset) 0 var(--boxy-color);padding:1rem;margin-top:var(--title-top-margin);margin-bottom:2rem;}/*!sc*/
.jmvzGK a:hover{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g7[id="Titles__TitleDiv-sc-5xl7gs-0"]{content:"jmvzGK,"}/*!sc*/
</style><link as="script" rel="preload" href="/webpack-runtime-d8157e8dded65c3ff337.js"/><link as="script" rel="preload" href="/framework-065c3db88fdd2b546387.js"/><link as="script" rel="preload" href="/app-8b28952f62241afbe9f6.js"/><link as="script" rel="preload" href="/component---src-pages-post-slug-tsx-d0a722fe664509218382.js"/><link as="fetch" rel="preload" href="/page-data/2018/04/24/drawing-fractals-in-the-browser-with-l-systems-and-es6/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="Layout__Container-sc-1arw8t8-0 cnoNVM"><div class="page"><div id="content"><div id="menu" class="Menu__MenuContainer-zgpfzl-0 goernf menu"><a class="Menu__MenuLink-zgpfzl-1 hRhFsN item" href="/"><i class="icon home"></i>travisgeis.com</a><a class="Menu__MenuLink-zgpfzl-1 hRhFsN item" href="/contact"><i class="icon comments"></i>Contact</a></div><div id="titles" class="Titles__TitleDiv-sc-5xl7gs-0 jmvzGK"><h1>Drawing fractals in the browser with L-systems and ES6</h1><h3>24 April 2018</h3></div><i>About a <!-- -->9<!-- -->-minute read</i><p>This article is from a recent engineering talk I gave at <a href="https://www.qualia.com">Qualia</a>.</p><div style="position:relative;padding-bottom:54%"><iframe src="https://gfycat.com/ifr/GrotesqueEasygoingDog" frameBorder="0" scrolling="no" width="100%" height="100%" style="position:absolute;top:0;left:0" allowfullscreen=""></iframe></div><p>Here’s what we’ll make! L-systems are great for modeling plants…</p><p>Fractals are a beautiful cross between math, visualization, and art. Unfortunately, making computer programs draw pictures can be pretty complicated. Luckily, modern web browsers have powerful graphics features built in, and nearly everyone has a web browser. The browser is actually a pretty good place to start playing around with fractal graphics!</p><p>In this post, we will look at one simple approach for modeling fractals, and how to draw them in the web browser. I’ll also cover a cool new feature of JavaScript, called generators, and show how they might come in handy for drawing fractals.</p><h2>Some theory: modeling fractals with L-systems</h2><p>To start things off, let’s think about how we might represent a fractal in a computer program. There are many ways to think about fractals, but in this post, I want to focus on one approach, called L-systems, because they are easy to understand and quick to implement.</p><p>Aristid Lindenmeyer invented <a href="https://en.wikipedia.org/wiki/L-system">L-systems</a>, or Lindenmeyer systems, as a way to model the growth of bacteria and fungi, and people later used them to model plants and other biological systems. The basic idea of an L-system is to use strings of characters to model the evolution of a living system. Each character symbolizes some part of the creature, like a cell, leaf, or branch. The system starts with an initial string, and by following some rules for manipulating the initial string, we end up modeling the change in the living creature over time by generating progressively more complex strings.</p><h3>Defining the L-system</h3><p>An L-system is a formal grammar, which means it is a set of rules for producing strings in a formal language. Mathematically, it’s defined as a tuple,</p><p>G = (V, ω, P)</p><p>where:</p><ul><li>V is the alphabet of characters, or symbols</li><li>ω is the starting string, also called the axiom, containing symbols from V</li><li>P is a set of production rules, also called “productions,” for evolving the system from one string to the next.</li></ul><p>Each production specifies how to convert one input character from the current state of the system into one or more output characters for the next state.</p><p>Starting with the axiom, we apply the appropriate production to each character to get the string representing the first generation. To get the second generation, we apply our productions to all of the symbols in the first generation, and so on. We can model generations indefinitely by applying the productions again and again.</p><p>Despite the complex-sounding theory, L-systems are really just find-and-replace rules, like you would use in a basic text editor.</p><h3>Modeling a plant</h3><p>Let’s look at how to model this tree-like plant:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1015px">
      <a class="gatsby-resp-image-link" href="/static/a122b5f9b0a1a4f362e2bc97c41c8739/e088a/three-trees.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:49.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABP0lEQVQoz4WRT4vCMBDF+6W9+AVEXMSjpece9CIIUnoRxFOhFIN/LgEPKVpT1iqltDZpZpY1UrWy7DsMJLzfTDLPwD8EAPifjNoKAGmaxnF8vV4RUSkFAFmWcc6TJHltKoTQnl+4KArGWBRFtm0TQjjniMgY45yPRiPf9w+Hg1IKES+Xy+l0IoTMZrMHTCldr9eMsfl8rtuHYRgEAefcdV0ppb6UUgZBEIYhIcT3/Qc8Ho+Hw+Futzsej9q3WCx6X73tdksp1V9AxKqqBoPBdDrdbDbPZzuO0263V6tVvSfP81qt1nK51EddhRCmaXY6HT0DAAxt7ff73+dzPYRS2u129/t9Teo6mUwsyypF+YQBIM9zIcRrDGVZ5nneyEYplWVZvQWjXkYDRsTb7faZrbzrDVZ3NXxVVX3COn8N/wDQQy3SzLt5ggAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Three fractal trees" title="Three fractal trees" src="/static/a122b5f9b0a1a4f362e2bc97c41c8739/e088a/three-trees.png" srcSet="/static/a122b5f9b0a1a4f362e2bc97c41c8739/5a46d/three-trees.png 300w,/static/a122b5f9b0a1a4f362e2bc97c41c8739/0a47e/three-trees.png 600w,/static/a122b5f9b0a1a4f362e2bc97c41c8739/e088a/three-trees.png 1015w" sizes="(max-width: 1015px) 100vw, 1015px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span>
Three fractal trees</p><p>First, we define the three elements of our L-system:</p><ul><li>V (the vocabulary) will contain the characters <code class="language-text">X</code> and <code class="language-text">F</code>, and the additional symbols <code class="language-text">[]+-</code></li><li>ω (the starting string) will just be <code class="language-text">X</code></li></ul><p>P will contain these two productions:</p><ul><li><code class="language-text">X</code>→<code class="language-text">F[−X][X]F[−X]+FX</code></li><li><code class="language-text">F</code>→<code class="language-text">FF</code></li></ul><p>In each generation, we will use one string to symbolize the current state of our model, which in this case is the shape of our plant. We begin by setting the state string equal to the axiom. To grow the plant by one generation, we replace the <code class="language-text">X</code> with <code class="language-text">F[−X][X]F[−X]+FX</code>. To grow it by another generation, we replace every <code class="language-text">X</code> with <code class="language-text">F[−X][X]F[−X]+FX</code>, and every <code class="language-text">F</code> with <code class="language-text">FF</code>.</p><p>We only have productions corresponding to <code class="language-text">X</code> and <code class="language-text">F</code>, so when we encounter any other character in the system state, like <code class="language-text">[</code>, we just copy it over to the new state string. Symbols like <code class="language-text">[</code>, for which there are no productions, are called constants.</p><p>The strings look complicated, but the process we follow is always the same: we replace each character in the current state string with the right-hand-side of its corresponding production rule.</p><h3>Evolving the model</h3><p>We’ve defined all we need for our L-system. Let’s evolve it for a few generations and see what happens!</p><p>To watch our model of a plant grow, we start with the axiom and run each rule on it:</p><div class="gatsby-highlight" data-language="text"><pre style="counter-reset:linenumber NaN" class="language-text line-numbers"><code class="language-text">X

F[−X][X]F[−X]+FX

FF[-F[-X][X]F[-X]+FX][F[-X][X]F[-X]+FX]FF[-F[-X][X]F[-X]+FX]+FFF[-X][X]F[-X]+FX

FFFF[-FF[-F[-X][X]F[-X]+FX][F[-X][X]F[-X]+FX]FF[-F[-X][X]F[-X]+FX]+FFF[-X][X]F[-X]+FX][FF[-F[-X][X]F[-X]+FX][F[-X][X]F[-X]+FX]FF[-F[-X][X]F[-X]+FX]+FFF[-X][X]F[-X]+FX]FFFF[-FF[-F[-X][X]F[-X]+FX][F[-X][X]F[-X]+FX]FF[-F[-X][X]F[-X]+FX]+FFF[-X][X]F[-X]+FX]+FFFFFF[-F[-X][X]F[-X]+FX][F[-X][X]F[-X]+FX]FF[-F[-X][X]F[-X]+FX]+FFF[-X][X]F[-X]+FX</code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>After only four generations, this system already looks pretty complex! We can see a sequence of F characters collecting at the beginning of the state string. Those characters represent the initial trunk or stem of our plant. In each generation, the trunk gets twice as long because of our production <code class="language-text">F</code>→<code class="language-text">FF</code>.</p><p>We can also see that the output of the production rule <code class="language-text">X</code>→<code class="language-text">F[−X][X]F[−X]+FX</code> is going to produce complex strings inside each set of square brackets. Each time we see <code class="language-text">[X]</code> or <code class="language-text">[-X]</code> in subsequent generations, we will end up substituting the output of the rule again between the square brackets. These parenthetical asides will represent the branches coming off the trunk of our tree, and each will grow fractally more complex in subsequent generations. We’ll soon see how to translate them into pictures, but first, let’s write some code to run the production rules automatically.</p><h2>Writing the L-system in code</h2><p>It’s perfectly possible to run the production rules of the L-system with pen and paper, but computers are really good at storing and manipulating strings, so we should have no trouble expressing L-systems in code!</p><p>Let’s set up a simple JavaScript file to model our tree fractal. We will start by declaring the axiom and production rules:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> tree <span class="token operator">=</span> <span class="token punctuation">{</span>
  axiom<span class="token operator">:</span> <span class="token string">&#x27;X&#x27;</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">X</span><span class="token operator">:</span> <span class="token string">&#x27;F[-X][X]F[-X]+FX&#x27;</span><span class="token punctuation">,</span>
    <span class="token constant">F</span><span class="token operator">:</span> <span class="token string">&#x27;FF&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>Here we represent the production rules with a simple JavaScript object, where each key is the input symbol for the production, and each value is the output string for that production. We don’t need to list the vocabulary explicitly, so we have fully defined our system.</p><p>Now, we need a way to run the production rules. Here’s a function to apply a single rule:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">applyRule</span><span class="token punctuation">(</span><span class="token parameter">rules<span class="token punctuation">,</span> char</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> rules<span class="token punctuation">[</span>char<span class="token punctuation">]</span> <span class="token operator">||</span> char<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span></span></pre></div><p>Given the rules and a character in the current system state, <code class="language-text">applyRule</code> returns the output of the rule if there is one, or the original character if there is no rule for it. Now, to get from one generation to the next, we just apply rules for every character in the current state, called <code class="language-text">previousGeneration</code> below:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">renderAGeneration</span><span class="token punctuation">(</span><span class="token parameter">system<span class="token punctuation">,</span> previousGeneration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> nextGeneration <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> character <span class="token keyword">of</span> previousGeneration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    nextGeneration <span class="token operator">+=</span> <span class="token function">applyRule</span><span class="token punctuation">(</span>system<span class="token punctuation">.</span>rules<span class="token punctuation">,</span> character<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> nextGeneration<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><h3>Try it out!</h3><p>Putting it all together, we have a way to simulate the L-system. Check out the “Result” tab in this JSFiddle to see the L-system evolve through several generations. If you “Edit in JSFiddle”, you can tweak <code class="language-text">numIters</code> to change how many generations the script simulates.</p><iframe width="100%" height="500" src="//jsfiddle.net/p35tpehv/17/embedded/" allowfullscreen="" frameBorder="0"></iframe><h2>Drawing the fractal</h2><p>Now we have an L-system to model our plant, but the raw strings don’t look much like a tree. To draw a fractal from the strings, we need to map each symbol to a drawing rule.</p><h3>Defining the drawing rules</h3><p>We’ll use an HTML canvas with <code class="language-text">p5.js</code> to handle the drawing. It’s possible to draw on a canvas without using a library, but p5 will make this a lot easier.</p><p>We’ll need to get a little bit of setup out of the way, to create a canvas and configure p5:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">createCanvas</span><span class="token punctuation">(</span><span class="token constant">CANVAS_BOUNDS</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token constant">CANVAS_BOUNDS</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">angleMode</span><span class="token punctuation">(</span><span class="token constant">DEGREES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">noLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>Now we need to map the symbols in the vocabulary of our L-system to functions that draw on the canvas. Let’s add a new property, <code class="language-text">commands</code>, to our system, to hold drawing functions:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> tree <span class="token operator">=</span> <span class="token punctuation">{</span>
  params<span class="token operator">:</span> <span class="token punctuation">{</span>
    angle<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
    length<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  axiom<span class="token operator">:</span> <span class="token string">&#x27;X&#x27;</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">X</span><span class="token operator">:</span> <span class="token string">&#x27;F[-X][X]F[-X]+FX&#x27;</span><span class="token punctuation">,</span>
    <span class="token constant">F</span><span class="token operator">:</span> <span class="token string">&#x27;FF&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  commands<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&#x27;F&#x27;</span><span class="token operator">:</span> drawForward<span class="token punctuation">,</span>
    <span class="token string">&#x27;-&#x27;</span><span class="token punctuation">(</span>drawingState<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      drawingState<span class="token punctuation">.</span>state<span class="token punctuation">.</span>direction <span class="token operator">-=</span> params<span class="token punctuation">.</span>angle<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&#x27;+&#x27;</span><span class="token punctuation">(</span>drawingState<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      drawingState<span class="token punctuation">.</span>state<span class="token punctuation">.</span>direction <span class="token operator">+=</span> params<span class="token punctuation">.</span>angle<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&#x27;[&#x27;</span><span class="token punctuation">(</span>drawingState<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      drawingState<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&#x27;]&#x27;</span><span class="token punctuation">(</span>drawingState<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      drawingState<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>Each command is a function. Its name corresponds to a symbol in the system state string. When we encounter the symbol, we run the function. For example, for every <code class="language-text">F</code> we see in the L-system’s state, we will call <code class="language-text">drawForward</code> (not yet defined) to draw a line straight forward. We’ve also added a few other concepts:</p><ul><li>We have some drawing parameters for our system in <code class="language-text">params</code>. We can add arbitrary configuration values here and then use them in our drawing functions. In this case, we configure the angle of the tree’s branches, and the length of each straight segment corresponding to an <code class="language-text">F</code>.</li><li>We give each drawing function access to the drawing <code class="language-text">params</code>, and to a <code class="language-text">drawingState</code>, which tracks the current drawing position and direction, and maintains a stack. We can push the position and direction of the drawing context to the stack, then later pop them to restore them as the current drawing state.</li></ul><p>If you’ve used Logo’s turtle graphics, this drawing style should feel familiar. We will imagine a pen that drags across the canvas, and when we pop a position off the stack of the <code class="language-text">drawingState</code>, we jump to the new location without drawing as though we lifted the pen.</p><p>Now we just need to call our drawing functions within <code class="language-text">renderAGeneration</code>:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">renderAGeneration</span> <span class="token punctuation">(</span><span class="token parameter">system<span class="token punctuation">,</span> previousGeneration<span class="token punctuation">,</span> drawingState<span class="token punctuation">,</span> draw<span class="token operator">=</span><span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> nextGeneration <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> character <span class="token keyword">of</span> previousGeneration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> nextCharacters <span class="token operator">=</span> <span class="token function">applyRule</span><span class="token punctuation">(</span>system<span class="token punctuation">.</span>rules<span class="token punctuation">,</span> character<span class="token punctuation">)</span><span class="token punctuation">;</span>
    nextGeneration <span class="token operator">+=</span> nextCharacters<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>draw<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> character <span class="token keyword">of</span> nextCharacters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>system<span class="token punctuation">.</span>commands<span class="token punctuation">[</span>character<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         system<span class="token punctuation">.</span>commands<span class="token punctuation">[</span>character<span class="token punctuation">]</span><span class="token punctuation">(</span>drawingState<span class="token punctuation">,</span> system<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> nextGeneration<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>Each time we apply a rule to one character in the <code class="language-text">previousGeneration</code>, we get a string of one or more characters in <code class="language-text">nextCharacters</code>, which we append to the string we’re building to represent the next generation of the L-system. For each of those characters, we look for a drawing function and call it if it exists. We also have a new boolean argument, <code class="language-text">draw</code>, which signals whether we should in fact draw something to the canvas. We’ll use it below.</p><p>We’re going to render the fractals when the user clicks the mouse. p5 comes out of the box with a mouse-click listener, so we just need to wrap our previous loop in a <code class="language-text">mouseClicked</code> function:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js">numIters <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
system <span class="token operator">=</span> tree<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">mouseClicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> origin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span>mouseX<span class="token punctuation">,</span> mouseY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> systemState <span class="token operator">=</span> system<span class="token punctuation">.</span>axiom<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>systemState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numIters<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> drawingState <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DrawingState</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> shouldDraw <span class="token operator">=</span> i <span class="token operator">===</span> numIters <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    systemState <span class="token operator">=</span> <span class="token function">renderAGeneration</span><span class="token punctuation">(</span>system<span class="token punctuation">,</span> systemState<span class="token punctuation">,</span> drawingState<span class="token punctuation">,</span> shouldDraw<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>systemState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>When the user clicks the canvas, we store the location of their click as the origin of the new drawing. We initialize system state to the axiom (<code class="language-text">X</code>), and then iterate through <code class="language-text">numIters</code> generations of the L-system. After each iteration, <code class="language-text">systemState</code> contains the new, more complex description of the fractal.</p><p>We wait to draw the fractal until it’s fully formed. The boolean <code class="language-text">shouldDraw</code> becomes true on the final iteration of the loop, signaling that <code class="language-text">renderAGeneration</code> should draw to the canvas.</p><h3>Try it out!</h3><p>You can play with the result in the “Result” tab below. Try clicking on the blank canvas!</p><iframe width="100%" height="500" src="//jsfiddle.net/msmoLw7t/24/embedded/" allowfullscreen="" frameBorder="0"></iframe><p>Now we’re drawing the fractal to the canvas, but we’re drawing the whole thing at once instead of gradually enhancing the drawing as we compute the new state of the L-system:</p><div style="position:relative;padding-bottom:77%"><iframe src="https://gfycat.com/ifr/AssuredKnobbyDonkey" frameBorder="0" scrolling="no" width="100%" height="100%" style="position:absolute;top:0;left:0" allowfullscreen=""></iframe></div><p>The fractals look right, but they need more animation!</p><p>Let’s animate the drawing to make it more fun to watch. We’ll use ES6 generators to do it.</p><h2>Animating the fractals</h2><p>So far, we have used synchronous code to generate our fractal descriptions and render them to the canvas. From the time the user clicks the mouse, triggering the <code class="language-text">mouseClicked</code> function, until the <code class="language-text">mouseClicked</code> function finishes running all of the functions it calls and returns, our code never yields the main thread of the browser’s JavaScript engine. Meanwhile, there is no way for the browser to update the drawing we see on the canvas!</p><p>To get the intermediate steps of the drawing to show up on the canvas, we need to design our code to yield the JavaScript thread to other code the browser is trying to run.</p><p>We will do two things to restructure our code:</p><ol><li>First, we will create a generator to yield intermediate fragments of the fractal as we create them</li><li>Second, we will use <code class="language-text">requestAnimationFrame</code> to draw each fragment</li></ol><h3>Using a generator to yield intermediate fragments</h3><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">Generators</a> are a new feature in JavaScript as of ES6. If you’ve used coroutines in other languages, they should feel familiar to you. MDN describes generators like this:</p><blockquote><p>Generators are functions which can be exited and later re-entered. Their context (variable bindings) will be saved across re-entrances. <!-- -->[…]</p><p>Calling a generator function does not execute its body immediately; an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#iterator">iterator</a> object for the function is returned instead. When the iterator’s next() method is called, the generator function’s body is executed until the first <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/yield"><code class="language-text">yield</code></a> expression, which specifies the value to be returned from the iterator <!-- -->[…]<!-- --> (from <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">MDN</a>)</p></blockquote><p>To create a generator, we declare a generator function, which returns an iterator. We can call <code class="language-text">next()</code> on the iterator repeatedly to get its values.</p><p>Let’s create a generator function that takes an L-system and its current state and produces an iterator for the L-system’s next state string:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">fragmentGenerator</span><span class="token punctuation">(</span><span class="token parameter">system<span class="token punctuation">,</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> char <span class="token keyword">of</span> string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token function">applyRule</span><span class="token punctuation">(</span>system<span class="token punctuation">.</span>rules<span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>We iterate through the characters of the string like before, but this time, instead of calling the corresponding drawing functions inside the loop, we <code class="language-text">yield</code> the fragment of characters that results from applying the rule.</p><p>To consume the generated fragments of the system state, first we invoke the generator function to get an iterator. Then, we call <code class="language-text">next()</code> on the iterator repeatedly, checking whether it is <code class="language-text">done</code> after each call:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// Create an iterator from our generator function</span>
<span class="token keyword">const</span> fragmentIterator <span class="token operator">=</span> <span class="token function">fragmentGenerator</span><span class="token punctuation">(</span>system<span class="token punctuation">,</span> systemState<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> iter<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>iter <span class="token operator">=</span> fragmentIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">!</span>iter<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fragment <span class="token operator">=</span> iter<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> character <span class="token keyword">of</span> fragment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// draw characters like before</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>Using a generator for the fragments allows us to observe the progress of applying each rule from the outside, in this case from our while loop. We’re on to something powerful, but so far, the effect is not different from what we had before.</p><p>We’re still looping through all of the fragments synchronously; we’ve just moved the synchronous iteration to a <code class="language-text">while</code> loop. For the final step, we will stop iterating in a loop at all and use <code class="language-text">requestAnimationFrame</code> instead.</p><h3>Rendering with requestAnimationFrame</h3><p>Instead of rendering the fractal within a loop, we need a way to render a frame, then yield the thread, then render another frame, yield the thread, and so on, giving the browser a chance to update the canvas each time our code stops running.</p><p>Our strategy will be to write a new function, <code class="language-text">drawFrame</code>, responsible for drawing just one frame of the animation. <code class="language-text">drawFrame</code> will make its changes to the canvas quickly, then return, allowing the browser to update the image of the canvas.</p><p>We won’t invoke <code class="language-text">drawFrame</code> directly; instead, we will pass it as a callback to <code class="language-text">requestAnimationFrame</code>, a function provided by the browser. The browser will call <code class="language-text">drawFrame</code> when it’s time to update the canvas (usually about 60 times per second). After we draw each frame, we will request another call to <code class="language-text">drawFrame</code> by calling <code class="language-text">requestAnimationFrame</code> again.</p><p>Here’s the code to set it all up:</p><div class="gatsby-highlight" data-language="js"><pre style="counter-reset:linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">function</span> <span class="token function">drawSystem</span><span class="token punctuation">(</span><span class="token parameter">system<span class="token punctuation">,</span> fragmentIterator<span class="token punctuation">,</span> drawingState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">drawFrame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> iter <span class="token operator">=</span> fragmentIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> fragment <span class="token operator">=</span> iter<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> character <span class="token keyword">of</span> fragment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> drawingFunction <span class="token operator">=</span> system<span class="token punctuation">.</span>commands<span class="token punctuation">[</span>character<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>drawingFunction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">drawingFunction</span><span class="token punctuation">(</span>drawingState<span class="token punctuation">,</span> system<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>drawFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>drawFrame<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>We define <code class="language-text">drawFrame</code> as a closure within <code class="language-text">drawSystem</code> so it will have access to the variables describing our L-system.</p><p>The core of <code class="language-text">drawFrame</code> is identical to the drawing code we’ve already seen. The big difference is that now, we iterate through the fragments of the L-system without using a loop! Between each run of <code class="language-text">drawFrame</code>, none of our JavaScript functions is running, and the browser has a chance to update the canvas.</p><h3>Try it out!</h3><p>Here’s the final code, showing everything we’ve covered working together to animate the fractals. Click on the canvas in the “Result” tab to kick off the animations, and try playing around with the parameters in JSFiddle! Have fun!</p><iframe width="100%" height="500" src="//jsfiddle.net/1x354b0o/26/embedded/" allowfullscreen="" frameBorder="0"></iframe><p>Thanks for reading! If you enjoyed this post, you might also enjoy <a href="https://www.qualia.com/careers/#/engineering">working at Qualia</a>! See you next time 👋</p><h2>Comments</h2><div id="cusdis_thread" data-host="https://travisgeis-cusdis.vercel.app" data-page-id="2018/04/24/drawing-fractals-in-the-browser-with-l-systems-and-es6/" data-app-id="bfc86e4c-f4e1-4135-8790-cf52804a5850" data-page-title="Drawing fractals in the browser with L-systems and ES6" data-page-url="https://travisgeis.com/2018/04/24/drawing-fractals-in-the-browser-with-l-systems-and-es6"></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2018/04/24/drawing-fractals-in-the-browser-with-l-systems-and-es6/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-8b28952f62241afbe9f6.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-933a06e9dadf888491cb.js"],"component---src-pages-page-slug-tsx":["/component---src-pages-page-slug-tsx-6a9c919aefa8eb61bff6.js"],"component---src-pages-post-slug-tsx":["/component---src-pages-post-slug-tsx-d0a722fe664509218382.js"],"component---src-pages-project-slug-tsx":["/component---src-pages-project-slug-tsx-0058ca5e225b60a2429a.js"],"component---src-templates-index-tsx":["/component---src-templates-index-tsx-be59b2f1846831e4e707.js"]};/*]]>*/</script><script src="/component---src-pages-post-slug-tsx-d0a722fe664509218382.js" async=""></script><script src="/app-8b28952f62241afbe9f6.js" async=""></script><script src="/framework-065c3db88fdd2b546387.js" async=""></script><script src="/webpack-runtime-d8157e8dded65c3ff337.js" async=""></script></body></html>