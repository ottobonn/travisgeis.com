{
    "componentChunkName": "component---src-pages-post-slug-tsx",
    "path": "/2023/11/30/precision-5510-thunderbolt/",
    "result": {"data":{"post":{"slug":"2023/11/30/precision-5510-thunderbolt","title":"Fixing Thunderbolt USB Dock for Dell Precision 5510","date":"30 November 2023","parent":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Fixing Thunderbolt USB Dock for Dell Precision 5510\",\n  \"lede\": \"The Precision 5510 shipped with notoriously buggy Thunderbolt firmware that finally seems fixed.\",\n  \"project\": \"Linux Quirks\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I bought a Thunderbolt dock, the Dell WD22TB4. As the name hints, this dock came out in 2022 and sports Thunderbolt 4, while my Precision 5510 laptop from 2017 has Thunderbolt 3. Fortunately, like USB, Thunderbolt is backwards-compatible, so this dock \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"should\"), \" work with my laptop. I used the same dock with a work laptop, a five-generations-newer Precision 5560 also running Linux, and it worked great, delivering smooth 4K60 video and USB ports.\"), mdx(\"p\", null, \"Unfortunately, while my Precision 5510 could charge from the dock and pass video through it, it couldn\\u2019t use the USB ports. This incompatibility was just minor enough for me to keep using the new dock with its better video bitrate even while having to plug USB devices into the laptop directly again, a step backwards in convience compared to the previous USB-C dock with its worse video framerate. Thus began a months-long albeit intermittent search for the problem, and I am happy to report I found the solution!\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR\"), \": The Precision 5510\\u2019s Thunderbolt firmware is buggy, and updating it fixes the USB port issues on Linux. I found the latest firmware on LVFS, installed it with fwupdmgr, and now the USB ports on my dock work great! Here are the steps to do the same:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Identify the version of Thunderbolt controller firmware on your Precision 5510:\"), mdx(\"div\", {\n    parentName: \"li\",\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"style\": {\n      \"counterReset\": \"linenumber NaN\"\n    },\n    \"className\": \"language-text line-numbers\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"  > fwupdmgr get-devices\\n\\n  Precision 5510\\n  \\u2502\\n  \\u2514\\u2500Thunderbolt host controller:\\n        Device ID:          cfad6899e91b587ba93beb78d57bae8001bd305b\\n        Summary:            Unmatched performance for high-speed I/O\\n        Current version:    12.00\\n        Vendor:             Dell (THUNDERBOLT:0x00D4, TBT:0x00D4)\\n        Update State:       Success\\n        GUIDs:              febe4287-5bce-5310-a1d4-32ed973cd977\\n                            351e2f41-8007-59d6-8dc8-1a00a83e8ea5\\n                            17c9727e-0343-5eb3-bd40-c54b1ed85e27\\n                            4b0fa34e-5dd2-5ee0-9112-94e951a74823\\n        Device Flags:       \\u2022 Internal device\\n                            \\u2022 Updatable\\n                            \\u2022 System requires external power source\\n                            \\u2022 Device stages updates\\n                            \\u2022 Signed Payload\"), mdx(\"span\", {\n    parentName: \"pre\",\n    \"aria-hidden\": \"true\",\n    \"className\": \"line-numbers-rows\",\n    \"style\": {\n      \"whiteSpace\": \"normal\",\n      \"width\": \"auto\",\n      \"left\": \"0\"\n    }\n  }, mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  }), mdx(\"span\", {\n    parentName: \"span\"\n  })))), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"That Thunderbolt host controller is the part responsible for handling Thunderbolt peripheral connections. Notice that it\\u2019s version 12.00? The current version is actually supposed to be 16!\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Download the firmware from LVFS. Dell distributes their official firmware images for Linux through LVFS. At the time of writing, \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://fwupd.org/lvfs/devices/com.dell.tbt17c9727e.firmware\"\n  }, \"this was the latest version\"), \". It has a filename like \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"8FDJ2_NVM16.00.cab\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Install the firmware with \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"fwupdmgr\"), \":\"), mdx(\"div\", {\n    parentName: \"li\",\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"style\": {\n      \"counterReset\": \"linenumber NaN\"\n    },\n    \"className\": \"language-text line-numbers\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"> fwupdmgr install 8FDJ2_NVM16.00.cab\"), mdx(\"span\", {\n    parentName: \"pre\",\n    \"aria-hidden\": \"true\",\n    \"className\": \"line-numbers-rows\",\n    \"style\": {\n      \"whiteSpace\": \"normal\",\n      \"width\": \"auto\",\n      \"left\": \"0\"\n    }\n  }, mdx(\"span\", {\n    parentName: \"span\"\n  })))), mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"fwupdmgr\"), \" will automatically unpack this CAB file, find the appropriate device to apply it to, install it, and restart the Thunderbolt controller.\"))), mdx(\"hr\", null), mdx(\"p\", null, \"That\\u2019s it! After months of searching for a problem in the Linux kernel, looking through the Arch forums, StackOverflow, UbuntuForums, and AskUbuntu, it turns out that Linux wasn\\u2019t the issue at all.\"), mdx(\"p\", null, \"This laptop came out early in the Thunderbolt 3 days, when Linux support for Thunderbolt was just getting started and even support on Windows was hit or miss. Since then, Thunderbolt drivers on Linux have come a long way, and the experience is generally excellent for simple things like a USB dock.\"), mdx(\"p\", null, \"Thunderbolt is such a complex interface that it feels like we are in a new era of hardware-software abstraction leaks, where it\\u2019s harder than ever to trust drivers for formerly-basic peripherals. Because Thunderbolt exposes a whole PCI bus to the outside world, there are tons of new edge cases, many of which seem to happen in the firmware. The mere capability to update the firmware in the Thunderbolt controller feels like a hint that there will be issues, a concession to not getting it just right the first time around.\"), mdx(\"p\", null, \"In contrast to something like USB, where the controller chip either does its job or you toss it out and find a new one, Thunderbolt controllers offer some sliding scale of capability and compatibility that requires much deeper analysis, with debugging tools that I don\\u2019t have, and updating the firmware can change those capabilities.\"), mdx(\"p\", null, \"Hopefully, as support for Thunderbolt matures and the edge cases are better understood, using Thunderbolt will be entirely mundane. Maybe on newever hardware like the Precision 5560 I used, we\\u2019re already in that future. In the meantime, getting Thunderbolt working on this old laptop was an excercise in archaeology, because the firmware of the Thunderbolt controller lies outside the reach of kernel patches and doesn\\u2019t benefit from the regular updates to the rest of my OS.\"));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":2}}},"pageContext":{"id":"136c4e50-ae56-57f7-af70-4f3e987ea568","slug":"2023/11/30/precision-5510-thunderbolt","__params":{"slug":"2023"}}},
    "staticQueryHashes": []}